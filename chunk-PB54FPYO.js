import{a as X}from"./chunk-EOLJ7M3P.js";import{a as N,b as T,c as W,d as R,e as z,f as q,g as B,h as j,i as G,j as Y,k as U,l as H,m as J}from"./chunk-BWQENOGP.js";import{a as K}from"./chunk-TMF6H46K.js";import{a as Q}from"./chunk-4PCVNBAZ.js";import{B as f,C as S,G as u,K as l,L as o,M as t,N as M,O as y,P as b,Q as d,R as v,T as m,U as h,V as O,Y as _,Z as C,_ as x,aa as P,ea as w,ha as D,ia as I,ka as E,ma as F,o as p,oa as L,p as g,pa as k,sa as A,wa as V,y as a}from"./chunk-WLOU5G26.js";var Z=i=>["/customers",i];function ee(i,r){i&1&&M(0,"app-loading-spinner",4)}function te(i,r){if(i&1){let e=y();o(0,"app-alert",32),b("close",function(){p(e);let n=d(2);return g(n.errorMessage="")}),t()}if(i&2){let e=d(2);l("message",e.errorMessage)}}function ne(i,r){i&1&&(o(0,"span",33),m(1,"Name is required"),t())}function oe(i,r){i&1&&(o(0,"span",33),m(1,"Valid email is required"),t())}function ie(i,r){i&1&&(o(0,"span",33),m(1,"Company is required"),t())}function re(i,r){if(i&1&&(o(0,"option",34),m(1),t()),i&2){let e=r.$implicit;l("value",e),a(),h(e)}}function ae(i,r){if(i&1){let e=y();o(0,"div")(1,"header",5)(2,"a",6),m(3," \u2190 Back "),t(),o(4,"h1"),m(5),t()(),u(6,te,1,1,"app-alert",7),o(7,"div",8)(8,"form",9,0),b("ngSubmit",function(){p(e);let n=d();return g(n.onSubmit())}),o(10,"div",10)(11,"div",11)(12,"label",12),m(13,"Name *"),t(),o(14,"input",13),x("ngModelChange",function(n){p(e);let s=d();return C(s.formData.name,n)||(s.formData.name=n),g(n)}),t(),u(15,ne,2,0,"span",14),t(),o(16,"div",11)(17,"label",15),m(18,"Email *"),t(),o(19,"input",16),x("ngModelChange",function(n){p(e);let s=d();return C(s.formData.email,n)||(s.formData.email=n),g(n)}),t(),u(20,oe,2,0,"span",14),t()(),o(21,"div",10)(22,"div",17)(23,"label",18),m(24,"Company *"),t(),o(25,"input",19),x("ngModelChange",function(n){p(e);let s=d();return C(s.formData.company,n)||(s.formData.company=n),g(n)}),t(),u(26,ie,2,0,"span",14),t()(),o(27,"div",10)(28,"div",11)(29,"label",20),m(30,"SLA Level *"),t(),o(31,"select",21),x("ngModelChange",function(n){p(e);let s=d();return C(s.formData.slaLevel,n)||(s.formData.slaLevel=n),g(n)}),u(32,re,2,2,"option",22),t()(),o(33,"div",11)(34,"label",23),m(35,"Status"),t(),o(36,"div",24)(37,"label",25)(38,"input",26),x("ngModelChange",function(n){p(e);let s=d();return C(s.formData.isActive,n)||(s.formData.isActive=n),g(n)}),t(),M(39,"span",27),t(),o(40,"span",28),m(41),t()()()(),o(42,"div",29)(43,"a",30),m(44," Cancel "),t(),o(45,"button",31),m(46),t()()()()()}if(i&2){let e=d();a(2),l("routerLink",e.isEdit?P(22,Z,e.customerId):"/customers"),a(3),h(e.isEdit?"Edit Customer":"Add New Customer"),a(),l("ngIf",e.errorMessage),a(8),v("error",e.submitted&&!e.formData.name),_("ngModel",e.formData.name),a(),l("ngIf",e.submitted&&!e.formData.name),a(4),v("error",e.submitted&&!e.formData.email),_("ngModel",e.formData.email),a(),l("ngIf",e.submitted&&!e.formData.email),a(5),v("error",e.submitted&&!e.formData.company),_("ngModel",e.formData.company),a(),l("ngIf",e.submitted&&!e.formData.company),a(5),_("ngModel",e.formData.slaLevel),a(),l("ngForOf",e.slaLevels),a(6),_("ngModel",e.formData.isActive),a(3),h(e.formData.isActive?"Active":"Inactive"),a(2),l("routerLink",e.isEdit?P(24,Z,e.customerId):"/customers"),a(2),l("disabled",e.saving),a(),O(" ",e.saving?"Saving...":e.isEdit?"Update Customer":"Add Customer"," ")}}var $=class i{constructor(r,e,c,n,s){this.route=r;this.router=e;this.customerService=c;this.authService=n;this.cdr=s}isEdit=!1;customerId=null;loading=!0;saving=!1;submitted=!1;errorMessage="";slaLevels=["Gold","Silver","Bronze"];formData={name:"",email:"",company:"",slaLevel:"Silver",isActive:!0};ngOnInit(){if(!this.authService.isAdmin){this.router.navigate(["/customers"]);return}this.customerId=this.route.snapshot.paramMap.get("id"),this.isEdit=this.customerId!==null&&this.customerId!=="new",this.isEdit&&this.customerId?this.loadCustomer(this.customerId):this.loading=!1}loadCustomer(r){this.customerService.getCustomerById(r).subscribe({next:e=>{e&&(this.formData={name:e.name,email:e.email,company:e.company,slaLevel:e.slaLevel,isActive:e.isActive}),this.loading=!1,this.cdr.detectChanges()},error:e=>{console.error("Failed to load customer:",e),this.loading=!1,this.cdr.detectChanges()}})}onSubmit(){this.submitted=!0,this.errorMessage="",!(!this.formData.name||!this.formData.email||!this.formData.company)&&(this.saving=!0,this.isEdit&&this.customerId?this.customerService.updateCustomer(this.customerId,this.formData).subscribe({next:r=>{this.router.navigate(["/customers",r.id])},error:r=>{this.errorMessage=r.message||"Failed to update customer",this.saving=!1,this.cdr.detectChanges()}}):this.customerService.createCustomer(this.formData).subscribe({next:r=>{this.router.navigate(["/customers",r.id])},error:r=>{this.errorMessage=r.message||"Failed to create customer",this.saving=!1,this.cdr.detectChanges()}}))}static \u0275fac=function(e){return new(e||i)(f(F),f(L),f(Q),f(V),f(w))};static \u0275cmp=S({type:i,selectors:[["app-customer-form"]],decls:3,vars:2,consts:[["customerForm","ngForm"],["data-testid","customer-form-page",1,"customer-form-page"],["message","Loading...",4,"ngIf"],[4,"ngIf"],["message","Loading..."],[1,"page-header"],[1,"back-link",3,"routerLink"],["type","error",3,"message","close",4,"ngIf"],[1,"form-card"],[3,"ngSubmit"],[1,"form-row"],[1,"form-group"],["for","name"],["type","text","id","name","name","name","required","","data-testid","customer-form-name","placeholder","Customer or company name",3,"ngModelChange","ngModel"],["class","error-text",4,"ngIf"],["for","email"],["type","email","id","email","name","email","required","","email","","data-testid","customer-form-email","placeholder","contact@example.com",3,"ngModelChange","ngModel"],[1,"form-group","full-width"],["for","company"],["type","text","id","company","name","company","required","","data-testid","customer-form-company","placeholder","Company name",3,"ngModelChange","ngModel"],["for","slaLevel"],["id","slaLevel","name","slaLevel","required","","data-testid","customer-form-sla",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["for","isActive"],[1,"toggle-container"],[1,"toggle"],["type","checkbox","id","isActive","name","isActive","data-testid","customer-form-active",3,"ngModelChange","ngModel"],[1,"toggle-slider"],[1,"toggle-label"],[1,"form-actions"],["data-testid","customer-form-cancel",1,"btn-secondary",3,"routerLink"],["type","submit","data-testid","customer-form-save",1,"btn-primary",3,"disabled"],["type","error",3,"close","message"],[1,"error-text"],[3,"value"]],template:function(e,c){e&1&&(o(0,"div",1),u(1,ee,1,0,"app-loading-spinner",2)(2,ae,47,26,"div",3),t()),e&2&&(a(),l("ngIf",c.loading),a(),l("ngIf",!c.loading))},dependencies:[E,D,I,A,k,J,B,G,Y,T,N,j,W,R,U,H,q,z,K,X],styles:['.customer-form-page[_ngcontent-%COMP%]{max-width:700px;margin:0 auto;animation:_ngcontent-%COMP%_fadeIn .3s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.page-header[_ngcontent-%COMP%]{margin-bottom:24px}.back-link[_ngcontent-%COMP%]{color:#666;text-decoration:none;font-size:14px;display:inline-block;margin-bottom:8px}.back-link[_ngcontent-%COMP%]:hover{color:#0f3460}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Playfair Display,Georgia,serif;font-size:28px;color:#1a1a2e;margin:0}.form-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:32px;box-shadow:0 2px 8px #0000000f}.form-row[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:20px}.form-group[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:6px}.form-group.full-width[_ngcontent-%COMP%]{flex:1 1 100%}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;font-size:14px;color:#333}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:12px 14px;border:1px solid #ddd;border-radius:8px;font-size:14px;transition:all .2s ease;font-family:inherit}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#0f3460;box-shadow:0 0 0 3px #0f34601a}.form-group[_ngcontent-%COMP%]   input.error[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select.error[_ngcontent-%COMP%]{border-color:#e74c3c}.error-text[_ngcontent-%COMP%]{color:#e74c3c;font-size:13px}.toggle-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding-top:8px}.toggle[_ngcontent-%COMP%]{position:relative;display:inline-block;width:50px;height:28px}.toggle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.toggle-slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#ccc;transition:.3s;border-radius:28px}.toggle-slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:22px;width:22px;left:3px;bottom:3px;background-color:#fff;transition:.3s;border-radius:50%}.toggle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .toggle-slider[_ngcontent-%COMP%]{background-color:#27ae60}.toggle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .toggle-slider[_ngcontent-%COMP%]:before{transform:translate(22px)}.toggle-label[_ngcontent-%COMP%]{font-size:14px;color:#333;font-weight:500}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;margin-top:24px;padding-top:24px;border-top:1px solid #eee}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#0f3460,#16213e);color:#fff;border:none;padding:12px 24px;border-radius:8px;font-weight:600;font-size:14px;cursor:pointer;transition:all .2s ease}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 8px 20px #0f34604d}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{background:#f0f0f0;color:#333;border:none;padding:12px 24px;border-radius:8px;font-weight:600;font-size:14px;cursor:pointer;text-decoration:none;display:inline-block;transition:all .2s ease}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e0e0e0}@media(max-width:600px){.form-row[_ngcontent-%COMP%]{flex-direction:column}}']})};export{$ as CustomerFormComponent};
