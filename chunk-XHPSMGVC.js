import{a as o,b as s,c as a,j as c,m as u,va as d,wa as h}from"./chunk-NZYDAHZG.js";var l=class n{constructor(e){this.authService=e;this.resetData()}comments=[];nextCommentNumber=206;getRandomDelay(){return 250+Math.floor(Math.random()*1750)}withDelay(e){return new a(r=>{let t=this.getRandomDelay(),m=setTimeout(()=>{r.next(e),r.complete()},t);return()=>clearTimeout(m)})}withDelayError(e){return new a(r=>{let t=this.getRandomDelay(),m=setTimeout(()=>{r.error(e)},t);return()=>clearTimeout(m)})}resetData(){this.comments=JSON.parse(JSON.stringify(d)).map(e=>s(o({},e),{createdAt:new Date(e.createdAt)})),this.nextCommentNumber=206}getCommentsByTicketId(e){let r=this.comments.filter(t=>t.ticketId===e).sort((t,m)=>new Date(t.createdAt).getTime()-new Date(m.createdAt).getTime());return this.withDelay(r.map(t=>o({},t)))}addComment(e,r){let t=this.authService.currentUser;if(!t)return this.withDelayError(new Error("You must be logged in to add a comment"));let i={id:`CMT-${String(this.nextCommentNumber++).padStart(3,"0")}`,ticketId:e,authorUsername:t.username,message:r.message,createdAt:new Date};return this.comments.push(i),this.withDelay(o({},i))}static \u0275fac=function(r){return new(r||n)(u(h))};static \u0275prov=c({token:n,factory:n.\u0275fac,providedIn:"root"})};export{l as a};
